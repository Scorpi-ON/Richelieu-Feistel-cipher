(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const c of r)if(c.type==="childList")for(const i of c.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function t(r){const c={};return r.integrity&&(c.integrity=r.integrity),r.referrerPolicy&&(c.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?c.credentials="include":r.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(r){if(r.ep)return;r.ep=!0;const c=t(r);fetch(r.href,c)}})();const B={light:"‚òÄÔ∏è",dark:"üåë"},b=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)");function D(){const e=document.getElementById("switchThemeButton"),n=t=>{e.innerText=t==="dark"?B.light:B.dark,document.body.setAttribute("data-theme",t)};b.matches&&n("dark"),b.onchange=t=>{const o=t.matches?"dark":"light";n(o)},e.onclick=()=>{const t=document.body.getAttribute("data-theme")==="dark"?"light":"dark";n(t)}}function H(){const e=document.getElementById("cipherMethodCheckbox"),n=document.getElementById("richelieuInfo"),t=document.getElementById("feistelInfo"),o=document.getElementById("cipherMethodCheckboxRichelieuLabel"),r=document.getElementById("cipherMethodCheckboxFeistelLabel"),c=document.getElementById("sourceText");e.onchange=()=>{const s=e.checked?["add","remove"]:["remove","add"];n.classList[s[0]]("hidden"),t.classList[s[1]]("hidden"),o.classList[s[1]]("font-bold"),r.classList[s[0]]("font-bold"),c.dispatchEvent(new Event("input"))}}const x=new Error("–í —Ä–µ—à—ë—Ç–∫–µ –†–∏—à–µ–ª—å–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ —Å–≤–æ–±–æ–¥–Ω–∞—è –∫–ª–µ—Ç–∫–∞");function G(){const e=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz–ê–ë–í–ì–î–ï–Å–ñ–ó–ò–ô–ö–õ–ú–ù–û–ü–†–°–¢–£–§–•–¶–ß–®–©–™–´–¨–≠–Æ–Ø–∞–±–≤–≥–¥–µ—ë–∂–∑–∏–π–∫–ª–º–Ω–æ–ø—Ä—Å—Ç—É—Ñ—Ö—Ü—á—à—â—ä—ã—å—ç—é—è0123456789.!?,;:‚Äî'"¬´¬ª()`,n=Math.floor(Math.random()*e.length);return e[n]}function P(e,n,t){if(t.length===0)throw x;let o="",r=0;for(;r<e.length;)for(let c=0;c<n;++c)t.includes(c)?(o+=e[r]??" ",++r):o+=G();return o}function U(e,n,t){let o="";if(t.length===0)throw x;for(let r=0;r<e.length;++r)t.includes(r%n)&&(o+=e[r]);return o}const g=8,u=g<<2,L=4,k=(1n<<BigInt(u))-1n,l=u*L;function R(e,n){if(e<0)throw new Error("–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º–æ–µ —á–∏—Å–ª–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º —á–∏—Å–ª–æ–º");if(e>1n<<BigInt(n))throw new Error("–ü–µ—Ä–µ–¥–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏—Ç–æ–≤ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ —Ä–µ–∞–ª—å–Ω–æ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –±–∏—Ç–æ–≤ —á–∏—Å–ª–∞");let t=Array(n).fill(0),o=n-1;if(typeof e=="bigint")for(;e>0n;--o)t[o]=Number(e&1n),e>>=1n;else for(;e>0;--o)t[o]=e&1,e>>=1;return t}function M(e){return e.reduce((n,t,o)=>{const r=e.length-o-1;return t===1&&(n|=BigInt(t)<<BigInt(r)),n},0n)}function K(e){if(e<0n||e>=1n<<BigInt(l))throw new Error(`–ë–ª–æ–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º –æ—Ç 0 –¥–æ 2^${l} - 1`);let n=Array(L);for(let t=0,o=l-u;o>=0;++t,o-=u)n[t]=e>>BigInt(o)&k;return n}function Y(e){let n=l;return e.reduce((t,o)=>{if(o<0||o>=1n<<BigInt(u))throw new Error(`–ü–æ—Ç–æ–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º –æ—Ç 0 –¥–æ 2^${u} - 1`);return n-=u,o>0&&(t|=o<<BigInt(n)),t},0n)}const z="utf-8",j=[32,0,0,0],V=Uint32Array.BYTES_PER_ELEMENT;function v(e){const n=new ArrayBuffer(e.length*Uint32Array.BYTES_PER_ELEMENT);let t=new Uint32Array(n);for(let o=0;o<e.length;o++)t[o]=e.charCodeAt(o);return new Uint8Array(t.buffer)}function F(e){return new Uint32Array(e.buffer).reduce((t,o)=>t+String.fromCharCode(o),"")}function Z(e){const t=v(e).reduce((o,r)=>o+String.fromCharCode(r),"");return window.btoa(t)}function W(e){const n=window.atob(e),t=n.length,o=new Uint8Array(t);for(let r=0;r<t;r++)o[r]=n.charCodeAt(r);return F(o)}const d={encode:v,decode:F,base64Encode:Z,base64Decode:W,NAME:z,WHITESPACE_CODES:j,BYTES_PER_ELEMENT:V},p=l/g;function q(e){let n=Array.from(d.encode(e));const t=p-n.length%p;return t<p&&(n=[...Array(t/d.BYTES_PER_ELEMENT).fill(d.WHITESPACE_CODES).flat(),...n]),n}function $(e){const t=q(e).map(c=>R(c,g)).flat(),o=t.length/l,r=Array(o);for(let c=0,i=0;c<o;++c){const s=t.slice(i,i+=l);r[c]=M(s)}return r}function J(e){let n=new Uint8Array(p*e.length);const t=e.map(o=>R(o,l)).flat();for(let o=0,r=0;r<t.length;++o){const c=t.slice(r,r+=g),i=M(c);n[o]=Number(i)}return d.decode(n)}function _(e,n){return e^n}function Q(e,n){const t=_(e[0],n);return e=[e[1]^t,e[2]^t,e[3]^t,e[0]],e}function X(e,n){const t=_(e[3],n);return e=[e[3],e[0]^t,e[1]^t,e[2]^t],e}function I(e,n,t){let o=$(n),r;return e==="decrypt"?(t=t.toReversed(),r=Q):r=X,o=o.map(c=>{let i=K(c);return t.forEach(s=>{i=r(i,s)}),Y(i)}),J(o)}const w=new FileReader;function T(e,n,t,o){const c=!!new FormData(e).get("cipherMethodCheckbox"),i=Array.from(e.elements.namedItem("richelieuGrid")),s=i.reduce((m,O,N)=>(O.checked||m.push(N),m),[]),h=o==="source"?n.value:t.value,y=o==="source"?"encrypt":"decrypt";let a,f;if(c){const m=document.getElementById("keysText").value.split(`
`).map(BigInt);o==="source"?(a=d.base64Encode(I(y,h,m)),f=t):(a=I(y,d.base64Decode(h),m),f=n)}else s.length>0?o==="source"?(a=P(h,i.length,s),f=t):(a=U(h,i.length,s),f=n):(f=o==="source"?t:n,a=h);f.value=a}function A(e,n){const t=e.scrollHeight-e.clientHeight,o=n.scrollHeight-n.clientHeight,r=t>0?e.scrollTop/t:0;n.scrollTop=o*r}function C(e,n){if(e.files.length===0)return;const t=e.files[0];w.onload=o=>{n.value=o.target.result,n.dispatchEvent(new Event("input")),e.value=""},w.readAsText(t,d.NAME)}function S(e,n){const t=e.value,o=new Blob([t],{type:"text/plain;charset="+d.NAME}),r=URL.createObjectURL(o),c=document.createElement("a");c.href=r,c.download=n,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(r)}function ee(){const e=document.forms.namedItem("cipherForm"),n=e.elements.namedItem("sourceText"),t=e.elements.namedItem("encryptedText"),o=e.elements.namedItem("uploadSourceFileInput"),r=e.elements.namedItem("uploadEncryptedFileInput"),c=e.elements.namedItem("downloadSourceButton"),i=e.elements.namedItem("downloadEncryptedButton");n.oninput=()=>T(e,n,t,"source"),t.oninput=()=>T(e,n,t,"encrypted"),n.onscroll=()=>A(n,t),t.onscroll=()=>A(t,n),o.onchange=()=>C(o,n),r.onchange=()=>C(r,t),c.onclick=()=>S(n,"source.txt"),i.onclick=()=>S(t,"encrypted.txt")}function te(e,n){const t=document.createElement("table");t.id="richelieuGridTable",t.classList.add("table","w-8","mt-3");for(let o=0;o<e;++o){const r=t.insertRow();for(let c=0;c<n;++c){const i=r.insertCell(),s=document.createElement("input");s.name="richelieuGrid",s.type="checkbox",s.checked=!0,s.classList.add("checkbox","w-9","h-9","-m-3"),i.appendChild(s)}}return t}function ne(){const e=document.forms.namedItem("cipherForm"),t=new FormData(e).getAll("richelieuGridSize"),o=Number(t[0]),r=Number(t[1]);return{height:o,width:r}}function E(){var r;const e=document.getElementById("richelieuInfo"),{height:n,width:t}=ne(),o=te(n,t);(r=document.getElementById("richelieuGridTable"))==null||r.remove(),e.appendChild(o)}function oe(){const e=document.getElementById("richelieuGridSizeWidth"),n=document.getElementById("richelieuGridSizeHeight");e.onchange=E,n.onchange=E,E()}function re(e){return Array(e).fill(0).map(()=>Math.floor(Math.random()*(Number(k)+1)))}function ce(){const e=document.getElementById("genFeistelKeysBtn"),n=document.getElementById("keysText"),t=document.getElementById("sourceText");e.onclick=()=>{n.value=re(8).join(`
`),t.dispatchEvent(new Event("input"))},n.oninput=()=>{t.dispatchEvent(new Event("input"))}}window.addEventListener("DOMContentLoaded",()=>{D(),H(),ee(),oe(),ce()});
