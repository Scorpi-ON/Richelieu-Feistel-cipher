(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))n(c);new MutationObserver(c=>{for(const r of c)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(c){const r={};return c.integrity&&(r.integrity=c.integrity),c.referrerPolicy&&(r.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?r.credentials="include":c.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(c){if(c.ep)return;c.ep=!0;const r=t(c);fetch(c.href,r)}})();function F(){const e=document.getElementById("cipherMethodCheckbox"),o=document.getElementById("richelieuInfo"),t=document.getElementById("feistelInfo"),n=document.getElementById("cipherMethodCheckboxRichelieuLabel"),c=document.getElementById("cipherMethodCheckboxFeistelLabel"),r=document.getElementById("sourceText");e.onchange=()=>{const i=e.checked;o.classList.toggle("hidden",i),t.classList.toggle("hidden",!i),n.classList.toggle("font-bold",!i),c.classList.toggle("font-bold",i),r.dispatchEvent(new Event("input"))}}const p=8,a=p<<2,C=4,A=(1n<<BigInt(a))-1n,d=a*C;function S(e,o){if(e<0)throw new Error("–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º–æ–µ —á–∏—Å–ª–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º —á–∏—Å–ª–æ–º");if(e>=1n<<BigInt(o))throw new Error("–ü–µ—Ä–µ–¥–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏—Ç–æ–≤ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ —Ä–µ–∞–ª—å–Ω–æ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –±–∏—Ç–æ–≤ —á–∏—Å–ª–∞");const t=Array(o).fill(0);let n=o-1;if(typeof e=="bigint")for(;e>0n;--n)t[n]=Number(e&1n),e>>=1n;else for(;e>0;--n)t[n]=e&1,e>>=1;return t}function k(e){return e.reduce((o,t,n)=>{const c=e.length-n-1;return t===1&&(o|=BigInt(t)<<BigInt(c)),o},0n)}function _(e){if(e<0n||e>=1n<<BigInt(d))throw new Error(`–ë–ª–æ–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º –æ—Ç 0 –¥–æ 2^${d} - 1`);const o=Array(C);for(let t=0,n=d-a;n>=0;++t,n-=a)o[t]=e>>BigInt(n)&A;return o}function O(e){let o=d;return e.reduce((t,n)=>{if(n<0||n>=1n<<BigInt(a))throw new Error(`–ü–æ—Ç–æ–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º –æ—Ç 0 –¥–æ 2^${a} - 1`);return o-=a,n>0&&(t|=n<<BigInt(o)),t},0n)}const N="utf-8",D=[32,0,0,0],H=Uint32Array.BYTES_PER_ELEMENT;function L(e){const o=new ArrayBuffer(e.length*Uint32Array.BYTES_PER_ELEMENT),t=new Uint32Array(o);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return new Uint8Array(t.buffer)}function v(e){return new Uint32Array(e.buffer).reduce((t,n)=>t+String.fromCharCode(n),"")}function G(e){const t=L(e).reduce((n,c)=>n+String.fromCharCode(c),"");return window.btoa(t)}function K(e){const o=window.atob(e),t=o.length,n=new Uint8Array(t);for(let c=0;c<t;c++)n[c]=o.charCodeAt(c);return v(n)}const u={encode:L,decode:v,base64Encode:G,base64Decode:K,NAME:N,WHITESPACE_CODES:D,BYTES_PER_ELEMENT:H},m=d/p;function P(e){let o=Array.from(u.encode(e));const t=m-o.length%m;return t<m&&(o=[...Array(t/u.BYTES_PER_ELEMENT).fill(u.WHITESPACE_CODES).flat(),...o]),o}function U(e){const t=P(e).map(r=>S(r,p)).flat(),n=t.length/d,c=Array(n);for(let r=0,i=0;r<n;++r){const s=t.slice(i,i+=d);c[r]=k(s)}return c}function Y(e){const o=new Uint8Array(m*e.length),t=e.map(n=>S(n,d)).flat();for(let n=0,c=0;c<t.length;++n){const r=t.slice(c,c+=p),i=k(r);o[n]=Number(i)}return u.decode(o)}function R(e,o){return e^o}function z(e,o){const t=R(e[0],o);return e=[e[1]^t,e[2]^t,e[3]^t,e[0]],e}function j(e,o){const t=R(e[3],o);return e=[e[3],e[0]^t,e[1]^t,e[2]^t],e}function B(e,o,t){let n=U(o),c;return e==="decrypt"?(t=t.toReversed(),c=z):c=j,n=n.map(r=>{let i=_(r);return t.forEach(s=>{i=c(i,s)}),O(i)}),Y(n)}const M=new Error("–í —Ä–µ—à—ë—Ç–∫–µ –†–∏—à–µ–ª—å–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ —Å–≤–æ–±–æ–¥–Ω–∞—è –∫–ª–µ—Ç–∫–∞");function V(){const e=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz–ê–ë–í–ì–î–ï–Å–ñ–ó–ò–ô–ö–õ–ú–ù–û–ü–†–°–¢–£–§–•–¶–ß–®–©–™–´–¨–≠–Æ–Ø–∞–±–≤–≥–¥–µ—ë–∂–∑–∏–π–∫–ª–º–Ω–æ–ø—Ä—Å—Ç—É—Ñ—Ö—Ü—á—à—â—ä—ã—å—ç—é—è0123456789.!?,;:‚Äî'"¬´¬ª()`,o=Math.floor(Math.random()*e.length);return e[o]}function Z(e,o,t){if(t.length===0)throw M;const n=new Set(t);let c="",r=0;for(;r<e.length;)for(let i=0;i<o;++i)n.has(i)?(c+=e[r]??" ",++r):c+=V();return c}function W(e,o,t){let n="";if(t.length===0)throw M;const c=new Set(t);for(let r=0;r<e.length;++r)c.has(r%o)&&(n+=e[r]);return n}function q(e){return e.split(/\r?\n/).map(o=>o.trim()).filter(o=>o.length>0).map(o=>BigInt(o))}function $(e){const o=[];return e.forEach((t,n)=>{t.checked||o.push(n)}),o}function b(e,o,t,n,c,r){const i=r==="source"?n.value:c.value,s=r==="source"?"encrypt":"decrypt",l=r==="source"?c:n;if(o.checked){const I=q(t.value);l.value=r==="source"?u.base64Encode(B(s,i,I)):B(s,u.base64Decode(i),I);return}const f=Array.from(e.elements.namedItem("richelieuGrid")),h=$(f);if(h.length===0){l.value=i;return}l.value=r==="source"?Z(i,f.length,h):W(i,f.length,h)}function w(e,o){const t=e.scrollHeight-e.clientHeight,n=o.scrollHeight-o.clientHeight,c=t>0?e.scrollTop/t:0;o.scrollTop=n*c}function g(e,o){var c;const t=(c=e.files)==null?void 0:c[0];if(!t)return;const n=new FileReader;n.onload=()=>{const r=n.result;o.value=typeof r=="string"?r:"",o.dispatchEvent(new Event("input")),e.value=""},n.readAsText(t,u.NAME)}function y(e,o){const t=e.value,n=new Blob([t],{type:"text/plain;charset="+u.NAME}),c=URL.createObjectURL(n),r=document.createElement("a");r.href=c,r.download=o,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(c)}function J(){const e=document.forms.namedItem("cipherForm"),o=e.elements.namedItem("cipherMethodCheckbox"),t=e.elements.namedItem("sourceText"),n=e.elements.namedItem("encryptedText"),c=e.elements.namedItem("keysText"),r=e.elements.namedItem("uploadKeysFileInput"),i=e.elements.namedItem("uploadSourceFileInput"),s=e.elements.namedItem("uploadEncryptedFileInput"),l=e.elements.namedItem("downloadKeysButton"),f=e.elements.namedItem("downloadSourceButton"),h=e.elements.namedItem("downloadEncryptedButton");t.oninput=()=>{b(e,o,c,t,n,"source")},n.oninput=()=>{b(e,o,c,t,n,"encrypted")},t.onscroll=()=>{w(t,n)},n.onscroll=()=>{w(n,t)},i.onchange=()=>{g(i,t)},s.onchange=()=>{g(s,n)},r.onchange=()=>{g(r,c)},l.onclick=()=>{y(c,"feistel-keys.txt")},f.onclick=()=>{y(t,"source.txt")},h.onclick=()=>{y(n,"encrypted.txt")}}const T={light:"‚òÄÔ∏è",dark:"üåë"},x=window.matchMedia("(prefers-color-scheme: dark)");function Q(){const e=document.getElementById("switchThemeButton"),o=t=>{e.innerText=t==="dark"?T.light:T.dark,document.body.setAttribute("data-theme",t)};x.matches&&o("dark"),x.onchange=t=>{const n=t.matches?"dark":"light";o(n)},e.onclick=()=>{const t=document.body.getAttribute("data-theme")==="dark"?"light":"dark";o(t)}}function X(e){return Array(e).fill(0).map(()=>Math.floor(Math.random()*(Number(A)+1)))}function ee(){const e=document.getElementById("genFeistelKeysBtn"),o=document.getElementById("keysText"),t=document.getElementById("sourceText");e.onclick=()=>{o.value=X(8).join(`
`),t.dispatchEvent(new Event("input"))},o.oninput=()=>{t.dispatchEvent(new Event("input"))}}function te(e,o,t){const n=document.createElement("table");n.id="richelieuGridTable",n.classList.add("table","w-8","mt-3");for(let c=0;c<e;++c){const r=n.insertRow();for(let i=0;i<o;++i){const s=r.insertCell(),l=document.createElement("input");l.name="richelieuGrid",l.type="checkbox",l.checked=!0,l.classList.add("checkbox","w-9","h-9","-m-3"),s.appendChild(l)}}return n.addEventListener("change",t),n}function ne(){const e=document.forms.namedItem("cipherForm"),t=new FormData(e).getAll("richelieuGridSize"),n=Number(t[0]),c=Number(t[1]);return{height:n,width:c}}function E(e){var r;const o=document.getElementById("richelieuInfo"),{height:t,width:n}=ne(),c=te(t,n,e);(r=document.getElementById("richelieuGridTable"))==null||r.remove(),o.appendChild(c),e()}function oe(){const e=document.getElementById("richelieuGridSizeWidth"),o=document.getElementById("richelieuGridSizeHeight"),t=document.getElementById("sourceText"),n=()=>{t.dispatchEvent(new Event("input"))};e.onchange=()=>{E(n)},o.onchange=()=>{E(n)},E(n)}window.addEventListener("DOMContentLoaded",()=>{Q(),F(),J(),oe(),ee()});
