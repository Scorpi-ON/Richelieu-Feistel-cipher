(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const r of c)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function t(c){const r={};return c.integrity&&(r.integrity=c.integrity),c.referrerPolicy&&(r.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?r.credentials="include":c.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(c){if(c.ep)return;c.ep=!0;const r=t(c);fetch(c.href,r)}})();function D(){const e=document.getElementById("cipherMethodCheckbox"),n=document.getElementById("richelieuInfo"),t=document.getElementById("feistelInfo"),o=document.getElementById("cipherMethodCheckboxRichelieuLabel"),c=document.getElementById("cipherMethodCheckboxFeistelLabel"),r=document.getElementById("sourceText");e.onchange=()=>{const s=e.checked?["add","remove"]:["remove","add"];n.classList[s[0]]("hidden"),t.classList[s[1]]("hidden"),o.classList[s[1]]("font-bold"),c.classList[s[0]]("font-bold"),r.dispatchEvent(new Event("input"))}}const g=8,u=g<<2,x=4,L=(1n<<BigInt(u))-1n,l=u*x;function k(e,n){if(e<0)throw new Error("–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º–æ–µ —á–∏—Å–ª–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º —á–∏—Å–ª–æ–º");if(e>1n<<BigInt(n))throw new Error("–ü–µ—Ä–µ–¥–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∏—Ç–æ–≤ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ —Ä–µ–∞–ª—å–Ω–æ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –±–∏—Ç–æ–≤ —á–∏—Å–ª–∞");const t=Array(n).fill(0);let o=n-1;if(typeof e=="bigint")for(;e>0n;--o)t[o]=Number(e&1n),e>>=1n;else for(;e>0;--o)t[o]=e&1,e>>=1;return t}function R(e){return e.reduce((n,t,o)=>{const c=e.length-o-1;return t===1&&(n|=BigInt(t)<<BigInt(c)),n},0n)}function H(e){if(e<0n||e>=1n<<BigInt(l))throw new Error(`–ë–ª–æ–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º –æ—Ç 0 –¥–æ 2^${l} - 1`);const n=Array(x);for(let t=0,o=l-u;o>=0;++t,o-=u)n[t]=e>>BigInt(o)&L;return n}function G(e){let n=l;return e.reduce((t,o)=>{if(o<0||o>=1n<<BigInt(u))throw new Error(`–ü–æ—Ç–æ–∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º –æ—Ç 0 –¥–æ 2^${u} - 1`);return n-=u,o>0&&(t|=o<<BigInt(n)),t},0n)}const P="utf-8",U=[32,0,0,0],K=Uint32Array.BYTES_PER_ELEMENT;function v(e){const n=new ArrayBuffer(e.length*Uint32Array.BYTES_PER_ELEMENT),t=new Uint32Array(n);for(let o=0;o<e.length;o++)t[o]=e.charCodeAt(o);return new Uint8Array(t.buffer)}function M(e){return new Uint32Array(e.buffer).reduce((t,o)=>t+String.fromCharCode(o),"")}function Y(e){const t=v(e).reduce((o,c)=>o+String.fromCharCode(c),"");return window.btoa(t)}function z(e){const n=window.atob(e),t=n.length,o=new Uint8Array(t);for(let c=0;c<t;c++)o[c]=n.charCodeAt(c);return M(o)}const d={encode:v,decode:M,base64Encode:Y,base64Decode:z,NAME:P,WHITESPACE_CODES:U,BYTES_PER_ELEMENT:K},p=l/g;function j(e){let n=Array.from(d.encode(e));const t=p-n.length%p;return t<p&&(n=[...Array(t/d.BYTES_PER_ELEMENT).fill(d.WHITESPACE_CODES).flat(),...n]),n}function V(e){const t=j(e).map(r=>k(r,g)).flat(),o=t.length/l,c=Array(o);for(let r=0,i=0;r<o;++r){const s=t.slice(i,i+=l);c[r]=R(s)}return c}function Z(e){const n=new Uint8Array(p*e.length),t=e.map(o=>k(o,l)).flat();for(let o=0,c=0;c<t.length;++o){const r=t.slice(c,c+=g),i=R(r);n[o]=Number(i)}return d.decode(n)}function F(e,n){return e^n}function W(e,n){const t=F(e[0],n);return e=[e[1]^t,e[2]^t,e[3]^t,e[0]],e}function q(e,n){const t=F(e[3],n);return e=[e[3],e[0]^t,e[1]^t,e[2]^t],e}function B(e,n,t){let o=V(n),c;return e==="decrypt"?(t=t.toReversed(),c=W):c=q,o=o.map(r=>{let i=H(r);return t.forEach(s=>{i=c(i,s)}),G(i)}),Z(o)}const _=new Error("–í —Ä–µ—à—ë—Ç–∫–µ –†–∏—à–µ–ª—å–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ —Å–≤–æ–±–æ–¥–Ω–∞—è –∫–ª–µ—Ç–∫–∞");function $(){const e=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz–ê–ë–í–ì–î–ï–Å–ñ–ó–ò–ô–ö–õ–ú–ù–û–ü–†–°–¢–£–§–•–¶–ß–®–©–™–´–¨–≠–Æ–Ø–∞–±–≤–≥–¥–µ—ë–∂–∑–∏–π–∫–ª–º–Ω–æ–ø—Ä—Å—Ç—É—Ñ—Ö—Ü—á—à—â—ä—ã—å—ç—é—è0123456789.!?,;:‚Äî'"¬´¬ª()`,n=Math.floor(Math.random()*e.length);return e[n]}function J(e,n,t){if(t.length===0)throw _;let o="",c=0;for(;c<e.length;)for(let r=0;r<n;++r)t.includes(r)?(o+=e[c]??" ",++c):o+=$();return o}function Q(e,n,t){let o="";if(t.length===0)throw _;for(let c=0;c<e.length;++c)t.includes(c%n)&&(o+=e[c]);return o}const b=new FileReader;function I(e,n,t,o){const r=!!new FormData(e).get("cipherMethodCheckbox"),i=Array.from(e.elements.namedItem("richelieuGrid")),s=i.reduce((m,O,N)=>(O.checked||m.push(N),m),[]),h=o==="source"?n.value:t.value,y=o==="source"?"encrypt":"decrypt";let a,f;if(r){const m=document.getElementById("keysText").value.split(`
`).map(BigInt);o==="source"?(a=d.base64Encode(B(y,h,m)),f=t):(a=B(y,d.base64Decode(h),m),f=n)}else s.length>0?o==="source"?(a=J(h,i.length,s),f=t):(a=Q(h,i.length,s),f=n):(f=o==="source"?t:n,a=h);f.value=a}function w(e,n){const t=e.scrollHeight-e.clientHeight,o=n.scrollHeight-n.clientHeight,c=t>0?e.scrollTop/t:0;n.scrollTop=o*c}function T(e,n){if(e.files.length===0)return;const t=e.files[0];b.onload=o=>{n.value=o.target.result,n.dispatchEvent(new Event("input")),e.value=""},b.readAsText(t,d.NAME)}function A(e,n){const t=e.value,o=new Blob([t],{type:"text/plain;charset="+d.NAME}),c=URL.createObjectURL(o),r=document.createElement("a");r.href=c,r.download=n,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(c)}function X(){const e=document.forms.namedItem("cipherForm"),n=e.elements.namedItem("sourceText"),t=e.elements.namedItem("encryptedText"),o=e.elements.namedItem("uploadSourceFileInput"),c=e.elements.namedItem("uploadEncryptedFileInput"),r=e.elements.namedItem("downloadSourceButton"),i=e.elements.namedItem("downloadEncryptedButton");n.oninput=()=>{I(e,n,t,"source")},t.oninput=()=>{I(e,n,t,"encrypted")},n.onscroll=()=>{w(n,t)},t.onscroll=()=>{w(t,n)},o.onchange=()=>{T(o,n)},c.onchange=()=>{T(c,t)},r.onclick=()=>{A(n,"source.txt")},i.onclick=()=>{A(t,"encrypted.txt")}}const C={light:"‚òÄÔ∏è",dark:"üåë"},S=window.matchMedia("(prefers-color-scheme: dark)");function ee(){const e=document.getElementById("switchThemeButton"),n=t=>{e.innerText=t==="dark"?C.light:C.dark,document.body.setAttribute("data-theme",t)};S.matches&&n("dark"),S.onchange=t=>{const o=t.matches?"dark":"light";n(o)},e.onclick=()=>{const t=document.body.getAttribute("data-theme")==="dark"?"light":"dark";n(t)}}function te(e){return Array(e).fill(0).map(()=>Math.floor(Math.random()*(Number(L)+1)))}function ne(){const e=document.getElementById("genFeistelKeysBtn"),n=document.getElementById("keysText"),t=document.getElementById("sourceText");e.onclick=()=>{n.value=te(8).join(`
`),t.dispatchEvent(new Event("input"))},n.oninput=()=>{t.dispatchEvent(new Event("input"))}}function oe(e,n){const t=document.createElement("table");t.id="richelieuGridTable",t.classList.add("table","w-8","mt-3");for(let o=0;o<e;++o){const c=t.insertRow();for(let r=0;r<n;++r){const i=c.insertCell(),s=document.createElement("input");s.name="richelieuGrid",s.type="checkbox",s.checked=!0,s.classList.add("checkbox","w-9","h-9","-m-3"),i.appendChild(s)}}return t}function ce(){const e=document.forms.namedItem("cipherForm"),t=new FormData(e).getAll("richelieuGridSize"),o=Number(t[0]),c=Number(t[1]);return{height:o,width:c}}function E(){var c;const e=document.getElementById("richelieuInfo"),{height:n,width:t}=ce(),o=oe(n,t);(c=document.getElementById("richelieuGridTable"))==null||c.remove(),e.appendChild(o)}function re(){const e=document.getElementById("richelieuGridSizeWidth"),n=document.getElementById("richelieuGridSizeHeight");e.onchange=E,n.onchange=E,E()}window.addEventListener("DOMContentLoaded",()=>{ee(),D(),X(),re(),ne()});
